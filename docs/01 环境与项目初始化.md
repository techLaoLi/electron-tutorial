## 01 环境与项目初始化

- 目标：完成 Node.js、Electron 的安装与最小可运行项目骨架。

### Electron 基本概念

Electron 是一个使用 Web 技术构建跨平台桌面应用的开源框架。它将 Chromium 和 Node.js 结合在一起，让开发者可以使用 HTML、CSS 和 JavaScript 构建桌面应用。

#### 核心概念

1. **主进程 (Main Process)**
   - 每个 Electron 应用只有一个主进程
   - 负责创建和管理应用窗口、处理系统事件
   - 可以创建多个渲染进程

2. **渲染进程 (Renderer Process)**
   - 每个应用窗口对应一个渲染进程
   - 负责显示网页内容
   - 可以有多个渲染进程

3. **预加载脚本 (Preload Script)**
   - 在渲染进程加载网页内容之前执行
   - 提供主进程和渲染进程之间的安全通信桥梁
   - 可以暴露有限的 Node.js API 给渲染进程

4. **进程间通信 (IPC)**
   - 主进程和渲染进程之间通过 IPC 进行通信
   - 确保应用的安全性和功能完整性

### 必备环境
- Node.js（建议 LTS 版本）
- 包管理器：npm 或 pnpm 或 yarn

### 创建项目
```bash
mkdir electron-tutorial && cd electron-tutorial
npm init -y
npm i -D electron
```

### 最小目录结构
```
electron-tutorial/
  ├─ package.json
  ├─ src/
  │   ├─ main.ts    # 主进程入口
  │   ├─ preload.ts # 预加载脚本
  │   └─ renderer/  # 渲染进程资源（HTML/CSS/JS）
  └─ tsconfig.json  # 若使用 TypeScript
```

### 核心代码
```typescript
// src/main.ts
import { app, BrowserWindow } from 'electron'
import path from 'path'

const createWindow = () => {
  const mainWindow = new BrowserWindow({
    width: 800,
    height: 600,
    webPreferences: {
      preload: path.join(__dirname, 'preload.js')
    }
  })

  mainWindow.loadFile('src/renderer/index.html')
}

app.whenReady().then(() => {
  createWindow()

  app.on('activate', () => {
    if (BrowserWindow.getAllWindows().length === 0) createWindow()
  })
})

app.on('window-all-closed', () => {
  if (process.platform !== 'darwin') app.quit()
})
```

```typescript
// src/preload.ts
import { contextBridge } from 'electron'

contextBridge.exposeInMainWorld('electronAPI', {
  // 在此处定义安全的 IPC 通信接口
})
```

```html
<!-- 渲染进程页面（src/renderer/index.html） -->
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Hello World</title>
</head>
<body>
  <h1>Hello World!</h1>
  <script src="./renderer.js"></script>
</body>
</html>
```

### package.json 脚本
```json
{
  "main": "dist/main.js",
  "scripts": {
    "dev": "electron .",
    "build": "tsc -p ."
  }
}
```

> 使用 JavaScript 亦可，将入口指向 `main.js`，并移除 TypeScript 相关内容。

### 验证运行
- 准备 `src/main.ts` 最小窗口代码（详见第 04 章）
- 运行：`npm run dev`，看到空白窗口即成功

### 本章要点
- 理解 Electron 通过主进程启动应用
- 采用清晰的 `src` 结构，便于后续扩展
